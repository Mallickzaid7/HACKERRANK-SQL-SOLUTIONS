SOLUTION 1)

SELECT C.company_code, C.founder, 
COUNT(DISTINCT L.lead_manager_code), 
COUNT(DISTINCT S.senior_manager_code),
COUNT(DISTINCT M.manager_code), 
COUNT(DISTINCT E.employee_code)
from Company C 
JOIN 
Lead_Manager L
ON C.company_code=L.company_code
JOIN 
Senior_Manager S 
ON
L.company_code=S.company_code
JOIN 
Manager M 
ON
S.company_code=M.company_code
JOIN 
Employee E 
ON
M.company_code=E.company_code
GROUP BY 
    C.company_code, C.founder
order by C.company_code;



SOLUTION 2)

SELECT COMPANY_CODE, FOUNDER,
(SELECT COUNT(DISTINCT LEAD_MANAGER_CODE) FROM LEAD_MANAGER WHERE COMPANY_CODE = C.COMPANY_CODE),
(SELECT COUNT(DISTINCT SENIOR_MANAGER_CODE) FROM SENIOR_MANAGER WHERE COMPANY_CODE = C.COMPANY_CODE),
(SELECT COUNT(DISTINCT MANAGER_CODE) FROM MANAGER WHERE COMPANY_CODE = C.COMPANY_CODE),
(SELECT COUNT(DISTINCT EMPLOYEE_CODE) FROM EMPLOYEE WHERE COMPANY_CODE = C.COMPANY_CODE)
FROM COMPANY C
ORDER BY COMPANY_CODE;
